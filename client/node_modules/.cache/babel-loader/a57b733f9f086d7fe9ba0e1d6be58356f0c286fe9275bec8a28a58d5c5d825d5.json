{"ast":null,"code":"import _regeneratorRuntime from\"D:/NotesApp/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/NotesApp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from\"react\";import{deleteFromDb}from'../api/DeleteToDO';import{useMutation,useQueryClient}from'@tanstack/react-query';import DeleteIcon from'@mui/icons-material/Delete';import{updateToDo}from'../api/UpdateToDo';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function Note(props){var update=useMutation({mutationFn:updateToDo,// When mutate is called:\nonMutate:function(){var _onMutate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref){var todo,pid,previousTodo;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:todo=_ref.todo,pid=_ref.pid;_context.next=3;return queryClient.cancelQueries({queryKey:['todos',todo._id]});case 3:// Snapshot the previous value\npreviousTodo=queryClient.getQueryData(['todos',todo._id]);// Optimistically update to the new value\nqueryClient.setQueryData(['todos',todo._id,todo]);// Return a context with the previous and new todo\nreturn _context.abrupt(\"return\",{previousTodo:previousTodo,todo:todo});case 6:case\"end\":return _context.stop();}},_callee);}));function onMutate(_x){return _onMutate.apply(this,arguments);}return onMutate;}(),// If the mutation fails, use the context we returned above\nonError:function onError(err,newTodo,context){queryClient.setQueryData(['todos',context.newTodo.id],context.previousTodo);},// Always refetch after error or success:\nonSettled:function onSettled(newTodo){queryClient.invalidateQueries({queryKey:['todos',newTodo.id]});}});function handleClick(item,pid){item.completed=!item.completed;update.mutate({todo:item,pid:pid});}var queryClient=useQueryClient();var addTodoMutation=useMutation({mutationFn:deleteFromDb,onMutate:function(){var _onMutate2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(id){var previousTodos;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return queryClient.cancelQueries({queryKey:['todos']});case 2:previousTodos=queryClient.getQueryData(['todos']);queryClient.setQueryData(['todos'],function(old){return old.filter(function(t){return t._id!==id;});});return _context2.abrupt(\"return\",{previousTodos:previousTodos});case 5:case\"end\":return _context2.stop();}},_callee2);}));function onMutate(_x2){return _onMutate2.apply(this,arguments);}return onMutate;}(),onError:function onError(err,newTodo,context){queryClient.setQueryData(['todos'],context.previousTodos);},// Always refetch after error or success:\nonSettled:function onSettled(){queryClient.invalidateQueries({queryKey:['todos']});}});var handleDelete=function handleDelete(id){addTodoMutation.mutate(id);};return/*#__PURE__*/_jsxs(\"div\",{className:\"note\",children:[props.note.map(function(item){return/*#__PURE__*/_jsxs(\"ul\",{children:[\" \",/*#__PURE__*/_jsxs(\"li\",{style:{textDecoration:item.completed?\"line-through\":\"none\"},onClick:function onClick(){handleClick(item,props.id);},children:[item.title,\" \"]},item._id)]});}),/*#__PURE__*/_jsx(\"button\",{disabled:props.id?false:true,onClick:function onClick(){handleDelete(props.id);},children:/*#__PURE__*/_jsx(DeleteIcon,{})})]});}export default Note;","map":{"version":3,"names":["React","deleteFromDb","useMutation","useQueryClient","DeleteIcon","updateToDo","jsxs","_jsxs","jsx","_jsx","Note","props","update","mutationFn","onMutate","_onMutate","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","todo","pid","previousTodo","wrap","_callee$","_context","prev","next","queryClient","cancelQueries","queryKey","_id","getQueryData","setQueryData","abrupt","stop","_x","apply","arguments","onError","err","newTodo","context","id","onSettled","invalidateQueries","handleClick","item","completed","mutate","addTodoMutation","_onMutate2","_callee2","previousTodos","_callee2$","_context2","old","filter","t","_x2","handleDelete","className","children","note","map","style","textDecoration","onClick","title","disabled"],"sources":["D:/NotesApp/client/src/components/Note.js"],"sourcesContent":["import React from \"react\";\r\nimport {deleteFromDb} from '../api/DeleteToDO';\r\nimport {useMutation,useQueryClient}  from '@tanstack/react-query';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nimport {updateToDo} from '../api/UpdateToDo'\r\n\r\n\r\nfunction Note(props) {\r\n \r\n  const update = useMutation({\r\n    mutationFn: updateToDo,\r\n    // When mutate is called:\r\n    onMutate: async ({todo,pid}) => {\r\n    // Cancel any outgoing refetches\r\n      // (so they don't overwrite our optimistic update)\r\n      await queryClient.cancelQueries({ queryKey: ['todos', todo._id] })\r\n\r\n      // Snapshot the previous value\r\n      const previousTodo = queryClient.getQueryData(['todos',todo._id ])\r\n  \r\n      // Optimistically update to the new value\r\n      queryClient.setQueryData(['todos', todo._id,todo])\r\n  \r\n      // Return a context with the previous and new todo\r\n      return { previousTodo, todo }\r\n    },\r\n    // If the mutation fails, use the context we returned above\r\n    onError: (err, newTodo, context) => {\r\n      queryClient.setQueryData(\r\n        ['todos', context.newTodo.id],\r\n        context.previousTodo,\r\n      )\r\n    },\r\n    // Always refetch after error or success:\r\n    onSettled: (newTodo) => {\r\n\r\n      queryClient.invalidateQueries({ queryKey: ['todos', newTodo.id] })\r\n    \r\n    }})\r\n\r\n  function handleClick(item,pid) {\r\n    item.completed = !(item.completed);\r\n    update.mutate({todo:item,pid:pid})\r\n  }\r\n  \r\n  const queryClient = useQueryClient();\r\n  const addTodoMutation = useMutation({\r\n    mutationFn:  deleteFromDb,\r\n    onMutate: async (id) => {\r\n     await queryClient.cancelQueries({ queryKey: ['todos'] })\r\n     const previousTodos = queryClient.getQueryData(['todos'])\r\n    queryClient.setQueryData(['todos'], (old) => old.filter(t => t._id!==id))\r\n    return { previousTodos }\r\n  }, \r\n  onError: (err, newTodo, context) => {\r\n    queryClient.setQueryData(['todos'], context.previousTodos)\r\n  },\r\n  // Always refetch after error or success:\r\n  onSettled: () => {\r\n    queryClient.invalidateQueries({ queryKey: ['todos'] })\r\n    \r\n\r\n  },\r\n\r\n})\r\n  \r\nconst handleDelete = (id) => {\r\n  addTodoMutation.mutate(id)\r\n}\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"note\">\r\n      {  props.note.map((item) => {\r\n        return <ul> <li style = {{textDecoration:item.completed?\"line-through\":\"none\"}}  onClick={() => {handleClick(item,props.id)}} key={item._id} >{item.title} </li></ul>\r\n      })}\r\n      <button disabled = {props.id?false:true} onClick={() => {handleDelete(props.id)}}><DeleteIcon /></button>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\nexport default Note;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}